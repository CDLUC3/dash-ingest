<html>
  <head>
    <title>app/models/record.rb</title>
    
    <link href="../../report.css?0.17765479970014142" media="screen" rel="stylesheet" type="text/css" />
    <script src='../../jquery.js?0.15797094106074916'></script>
    <script>
      $(function() {

        $('#toggle_test_file').click(function(e) {
          e.preventDefault();
          if ($('#main_file').hasClass('side_by_side')) {
            $('#main_file').removeClass('side_by_side');
          } else {
            $('#main_file').addClass('side_by_side');
          }
        
          $('#test_file').toggle();
        });

        $('#test_file').hide();
        
        function cleanString(str) {
          return $.trim(str.replace(/<[^(<|>)]+>/gi, ''));
        }
        
        $('.line_number').hover(function() {
          $(this).attr('title', 'Line: ' + cleanString($(this).html()));
        });
        
        $('.hit_number').hover(function() {
          $(this).attr('title', 'Execution Count: ' + cleanString($(this).html()));
        });
        
        $('.code_line').hover(function() {
          $(this).attr('title', cleanString($(this).html()));
        });
        
      });
    </script>
  </head>
  <body>
    <h1><a href="../../index.html">Coverage Report</a></h1>
    
    <table cellpadding='0' cellspacing='1'>
      <tr class='header'>
        <th>File</th>
        <th>Lines</th>
        <th>Lines Of Code</th>
        <th>Untested Lines of Code</th>
        <th>Tested %</th>
      </tr>
      <tr valign='top'>
        <td>
          app/models/record.rb
          
        </td>
        <td>276</td>
        <td>106</td>
        <td>6</td>
        <td>94.3%</td>
      </tr>
    </table>

    <div>&nbsp;</div>
    
    <table cellpadding='0' cellspacing='1'>
      <tr>
        <th>Legend</th>
      </tr>
      <tr>
        <td class='hit'>This line was executed.</td>
      </tr>
      <tr>
        <td class='miss'>This line was not executed!</td>
      </tr>
      <tr>
        <td class='never'>This line doesn't matter.</td>
      </tr>
    </table>
    
    <div>&nbsp;</div>

    <div id='content'>
      <div id='main_file'>
        <table id='main'>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>1</td>
              <td class='code_line'>
                <pre>require 'rubygems'</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>2</td>
              <td class='code_line'>
                <pre>require 'zip/zip'</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>3</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>4</td>
              <td class='code_line'>
                <pre>class Record < ActiveRecord::Base    </pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>5</td>
              <td class='code_line'>
                <pre>  has_many :creators</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>6</td>
              <td class='code_line'>
                <pre>  has_many :contributors</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>7</td>
              <td class='code_line'>
                <pre>  has_many :descriptions</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>8</td>
              <td class='code_line'>
                <pre>  has_many :subjects</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>9</td>
              <td class='code_line'>
                <pre>  has_many :alternateIdentifiers</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>10</td>
              <td class='code_line'>
                <pre>  has_many :datauploads</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>11</td>
              <td class='code_line'>
                <pre>  has_many :relations</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>12</td>
              <td class='code_line'>
                <pre>  has_many :submissionLogs</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>13</td>
              <td class='code_line'>
                <pre>  has_many :uploads</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>14</td>
              <td class='code_line'>
                <pre>  </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>15</td>
              <td class='code_line'>
                <pre>  belongs_to :user</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>16</td>
              <td class='code_line'>
                <pre>  attr_accessible :identifier, :identifierType, :publicationyear, :publisher, :resourcetype, :rights, :title, :local_id</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>17</td>
              <td class='code_line'>
                <pre>  </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>18</td>
              <td class='code_line'>
                <pre>  def set_local_id</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>19</td>
              <td class='code_line'>
                <pre>    self.local_id = (0...10).map{ ('a'..'z').to_a[rand(26)] }.join</pre>
              </td>
              <td class='hit_number'>198</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>20</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>21</td>
              <td class='code_line'>
                <pre>  </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>22</td>
              <td class='code_line'>
                <pre>  def create_record_directory</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>23</td>
              <td class='code_line'>
                <pre>    FileUtils.mkdir("#{Rails.root}/#{DATASHARE_CONFIG['uploads_dir']}/#{self.local_id}")</pre>
              </td>
              <td class='hit_number'>18</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>24</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>25</td>
              <td class='code_line'>
                <pre>  </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>26</td>
              <td class='code_line'>
                <pre>  def review</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>27</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>28</td>
              <td class='code_line'>
                <pre>    # can we define the character encoding at UTF without a byte recorder marker</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>29</td>
              <td class='code_line'>
                <pre>    # ANSI encoding right now </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>30</td>
              <td class='code_line'>
                <pre>    </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>31</td>
              <td class='code_line'>
                <pre>    # note - for now, removing the tags to contain multiple XML entries.  This produces invalid XML.</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>32</td>
              <td class='code_line'>
                <pre>    # however, it appears to be necessary for the XTF index to work properly.  </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>33</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>34</td>
              <td class='code_line'>
                <pre>     f = File.new("#{Rails.root}/#{DATASHARE_CONFIG['uploads_dir']}/#{self.local_id}/datacite.xml", "w:ASCII-8BIT")</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>35</td>
              <td class='code_line'>
                <pre>    </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>36</td>
              <td class='code_line'>
                <pre>     f.puts "<?xml version=\"1.0\" encoding=\"UTF-8\"?>"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>37</td>
              <td class='code_line'>
                <pre>     f.puts "<resource xmlns=\"http://datacite.org/schema/kernel-3\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://datacite.org/schema/kernel-3 http://schema.datacite.org/meta/kernel-3/metadata.xsd\">"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>38</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>39</td>
              <td class='code_line'>
                <pre>     # identifier - datacite: single, mandatory</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>40</td>
              <td class='code_line'>
                <pre>     # left empty because it will be set by EZID on the merritt side</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>41</td>
              <td class='code_line'>
                <pre>     f.puts "<identifier identifierType=\"DOI\"></identifier>"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>42</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>43</td>
              <td class='code_line'>
                <pre>     # creators - datacite: multiple, mandatory</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>44</td>
              <td class='code_line'>
                <pre>     f.puts "<creators>"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>45</td>
              <td class='code_line'>
                <pre>     self.creators.each { |a| f.puts "<creator><creatorName>#{a.creatorName.gsub(/\r/,"")}</creatorName></creator>"}</pre>
              </td>
              <td class='hit_number'>18</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>46</td>
              <td class='code_line'>
                <pre>     f.puts "</creators>"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>47</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>48</td>
              <td class='code_line'>
                <pre>     # should we allow multiple titles?  datacite does...</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>49</td>
              <td class='code_line'>
                <pre>     # we're only allowing one title per record</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>50</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>51</td>
              <td class='code_line'>
                <pre>     # titles - datacite: multiple, mandatory</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>52</td>
              <td class='code_line'>
                <pre>     # datacite - title has an option type attribute that we are not using</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>53</td>
              <td class='code_line'>
                <pre>     f.puts "<titles>"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>54</td>
              <td class='code_line'>
                <pre>     f.puts "<title>#{self.title}</title>"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>55</td>
              <td class='code_line'>
                <pre>     f.puts "</titles>"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>56</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>57</td>
              <td class='code_line'>
                <pre>     # publisher - datacite: single, mandatory</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>58</td>
              <td class='code_line'>
                <pre>     f.puts "<publisher>#{self.publisher}</publisher>"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>59</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>60</td>
              <td class='code_line'>
                <pre>     # publication year - datacite: single, mandatory</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>61</td>
              <td class='code_line'>
                <pre>     f.puts "<publicationYear>#{self.publicationyear}</publicationYear>"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>62</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>63</td>
              <td class='code_line'>
                <pre>     # subjects - datacite: multiple, optional</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>64</td>
              <td class='code_line'>
                <pre>     f.puts "<subjects>"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>65</td>
              <td class='code_line'>
                <pre>     # subject scheme is optional and open</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>66</td>
              <td class='code_line'>
                <pre>     #self.subjects.each { |a| f.puts "<subject subjectScheme=\"#{a.subjectScheme.gsub(/\r/,"")}\">#{a.subjectName.gsub(/\r/,"")}</subject>"}</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>67</td>
              <td class='code_line'>
                <pre>     # for now, just use the subject without a scheme</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>68</td>
              <td class='code_line'>
                <pre>     self.subjects.each { |a| f.puts "<subject>#{a.subjectName.gsub(/\r/,"")}</subject>"}</pre>
              </td>
              <td class='hit_number'>18</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>69</td>
              <td class='code_line'>
                <pre>     f.puts "</subjects>"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>70</td>
              <td class='code_line'>
                <pre>         </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>71</td>
              <td class='code_line'>
                <pre>     #contributors - datacite: multiple, optional, mandatory contributorType attribute</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>72</td>
              <td class='code_line'>
                <pre>     # do we have a default value for contributorType?  </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>73</td>
              <td class='code_line'>
                <pre>     # is this something we plan to use?</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>74</td>
              <td class='code_line'>
                <pre>     f.puts "<contributors>"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>75</td>
              <td class='code_line'>
                <pre>     #self.contributors.each { |a| f.puts "<contributor contributorType=\"#{a.contributorType}\"><contributorName>#{a.contributorName.gsub(/\r/,"")}</contributorName></contributor>"}</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>76</td>
              <td class='code_line'>
                <pre>     self.contributors.each { |a| f.puts "<contributor contributorType=\"ResearchGroup\"><contributorName>#{a.contributorName.gsub(/\r/,"")}</contributorName></contributor>"}</pre>
              </td>
              <td class='hit_number'>18</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>77</td>
              <td class='code_line'>
                <pre>     f.puts "</contributors>"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>78</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>79</td>
              <td class='code_line'>
                <pre>     # resourceType - datacite: optional</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>80</td>
              <td class='code_line'>
                <pre>     # should have a resourceTypeGeneral and a resourceType, may need to modify this</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>81</td>
              <td class='code_line'>
                <pre>     #f.puts "<resourceType resourceTypeGeneral=\"#{self.resourcetype}\">#{self.resourcetype}</resourceType>"</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>82</td>
              <td class='code_line'>
                <pre>     f.puts "<resourceType resourceTypeGeneral=\"Dataset\">Dataset</resourceType>"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>83</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>84</td>
              <td class='code_line'>
                <pre>     # alternate Identifiers - datacite: optional</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>85</td>
              <td class='code_line'>
                <pre>     # this will be the localID</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>86</td>
              <td class='code_line'>
                <pre>     #f.puts "<alternateIdentifiers>"</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>87</td>
              <td class='code_line'>
                <pre>     #self.alternateIdentifiers.each { |a| f.puts "<alternateIdentifier alternateIdentifierType=\"#{a.alternateIdentifierType}\">#{a.alternateIdentifierName}</alternateIdentifier>"}</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>88</td>
              <td class='code_line'>
                <pre>     #f.puts "</alternateIdentifiers>"</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>89</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>90</td>
              <td class='code_line'>
                <pre>     # relatedIdentifiers - datacite: optional, multiple</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>91</td>
              <td class='code_line'>
                <pre>     # going to use this for citations</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>92</td>
              <td class='code_line'>
                <pre>     # and then relations doesn't exist in the datacite schema</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>93</td>
              <td class='code_line'>
                <pre>     # is this valid without the relatedIdentifiersType?</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>94</td>
              <td class='code_line'>
                <pre>     # should I be using a different description for this?  N</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>95</td>
              <td class='code_line'>
                <pre>     # not sure if this is a valid mapping...</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>96</td>
              <td class='code_line'>
                <pre>     #f.puts "<relatedIdentifiers>"</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>97</td>
              <td class='code_line'>
                <pre>     #self.relations.each { |a| f.puts "<relatedIdentifier>#{a.relationText.gsub(/\r/,"")}</relatedIdentifier>"}</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>98</td>
              <td class='code_line'>
                <pre>     #f.puts "</relatedIdentifiers>"</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>99</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>100</td>
              <td class='code_line'>
                <pre>     #<sizes>... this will be exported from merritt, but do we need it in the metadata?</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>101</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>102</td>
              <td class='code_line'>
                <pre>     # formats ?</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>103</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>104</td>
              <td class='code_line'>
                <pre>     # version?</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>105</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>106</td>
              <td class='code_line'>
                <pre>     #rights</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>107</td>
              <td class='code_line'>
                <pre>     #not required</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>108</td>
              <td class='code_line'>
                <pre>     #f.puts "<rights>#{self.rights}</rights>"</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>109</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>110</td>
              <td class='code_line'>
                <pre>     #descriptions</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>111</td>
              <td class='code_line'>
                <pre>     f.puts "<descriptions>" </pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>112</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>113</td>
              <td class='code_line'>
                <pre>     # abstract</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>114</td>
              <td class='code_line'>
                <pre>     if !self.abstract.nil?</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="miss" data-hits='#{cov}'"">
              <td class='line_number'>115</td>
              <td class='code_line'>
                <pre>       f.puts "<description descriptionType=\"Abstract\">#{CGI::escapeHTML(self.abstract.gsub(/\r/,""))}</description>"</pre>
              </td>
              <td class='hit_number'>0</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>116</td>
              <td class='code_line'>
                <pre>     end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>117</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>118</td>
              <td class='code_line'>
                <pre>     #methods</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>119</td>
              <td class='code_line'>
                <pre>     if !self.methods.nil?</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="miss" data-hits='#{cov}'"">
              <td class='line_number'>120</td>
              <td class='code_line'>
                <pre>       f.puts "<description descriptionType=\"Methods\">#{CGI::escapeHTML(self.methods.gsub(/\r/,""))}</description>"</pre>
              </td>
              <td class='hit_number'>0</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>121</td>
              <td class='code_line'>
                <pre>     end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>122</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>123</td>
              <td class='code_line'>
                <pre>     # citation</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>124</td>
              <td class='code_line'>
                <pre>       </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>125</td>
              <td class='code_line'>
                <pre>     self.descriptions.each { |a| f.puts "<description descriptionType=\"SeriesInformation\">#{CGI::escapeHTML(a.descriptionText.gsub(/\r/,""))}</description>" }</pre>
              </td>
              <td class='hit_number'>18</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>126</td>
              <td class='code_line'>
                <pre>       </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>127</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>128</td>
              <td class='code_line'>
                <pre>     f.puts "</descriptions>"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>129</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>130</td>
              <td class='code_line'>
                <pre>     f.puts "</resource>"   </pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>131</td>
              <td class='code_line'>
                <pre>          </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>132</td>
              <td class='code_line'>
                <pre>     f.close</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>133</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>134</td>
              <td class='code_line'>
                <pre>     #return contents of file as string</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>135</td>
              <td class='code_line'>
                <pre>     File.open("#{Rails.root}/#{DATASHARE_CONFIG['uploads_dir']}/#{self.local_id}/datacite.xml", "rb").read</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>136</td>
              <td class='code_line'>
                <pre>   end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>137</td>
              <td class='code_line'>
                <pre>   </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>138</td>
              <td class='code_line'>
                <pre>   def generate_merritt_zip</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>139</td>
              <td class='code_line'>
                <pre>     file_path = "#{Rails.root}/#{DATASHARE_CONFIG['uploads_dir']}/#{self.local_id}"</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>140</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>141</td>
              <td class='code_line'>
                <pre>    </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>142</td>
              <td class='code_line'>
                <pre>     if File.exists?("#{file_path}/#{self.local_id}.zip")</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="miss" data-hits='#{cov}'"">
              <td class='line_number'>143</td>
              <td class='code_line'>
                <pre>       File.delete("#{file_path}/#{self.local_id}.zip")</pre>
              </td>
              <td class='hit_number'>0</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>144</td>
              <td class='code_line'>
                <pre>     end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>145</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>146</td>
              <td class='code_line'>
                <pre>     zipfile_name = "#{file_path}/#{self.local_id}.zip"</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>147</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>148</td>
              <td class='code_line'>
                <pre>     # target link and doi are generated by merritt</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>149</td>
              <td class='code_line'>
                <pre>     # they are included here only for testing</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>150</td>
              <td class='code_line'>
                <pre>     # uncomment if you need them in the archive (ie, if your repository does not supply these)</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>151</td>
              <td class='code_line'>
                <pre>     f = File.new("#{file_path}/target_link", "w")  </pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>152</td>
              <td class='code_line'>
                <pre>     f.puts "http://localhost:3000/download_merritt_file/#{self.local_id}.zip"</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>153</td>
              <td class='code_line'>
                <pre>     f.close</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>154</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>155</td>
              <td class='code_line'>
                <pre>     f = File.new("#{file_path}/doi", "w")  </pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>156</td>
              <td class='code_line'>
                <pre>     f.puts "doi:10.7272/Q6057CV6"</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>157</td>
              <td class='code_line'>
                <pre>     f.close</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>158</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>159</td>
              <td class='code_line'>
                <pre>     f = File.new("#{file_path}/mrt-datacite.xml", "wb") </pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>160</td>
              <td class='code_line'>
                <pre>     f.puts self.review</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>161</td>
              <td class='code_line'>
                <pre>     f.close</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>162</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>163</td>
              <td class='code_line'>
                <pre>     Zip::ZipFile.open(zipfile_name, Zip::ZipFile::CREATE) do |zipfile|       </pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>164</td>
              <td class='code_line'>
                <pre>       zipfile.add("mrt-datacite.xml", "#{file_path}/mrt-datacite.xml")</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>165</td>
              <td class='code_line'>
                <pre>       </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>166</td>
              <td class='code_line'>
                <pre>       self.uploads.each do |d| </pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>167</td>
              <td class='code_line'>
                <pre>         </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>168</td>
              <td class='code_line'>
                <pre>          # a temporary terrible hack to avoid the file corruption problem</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>169</td>
              <td class='code_line'>
                <pre>          # on chunked uploads     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>170</td>
              <td class='code_line'>
                <pre>          </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>171</td>
              <td class='code_line'>
                <pre>          if File.exist?(file_path + "/temp_" + d.upload_file_name)</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="miss" data-hits='#{cov}'"">
              <td class='line_number'>172</td>
              <td class='code_line'>
                <pre>            File.delete(file_path + "/" + d.upload_file_name)</pre>
              </td>
              <td class='hit_number'>0</td>
            </tr>
          
            <tr class="miss" data-hits='#{cov}'"">
              <td class='line_number'>173</td>
              <td class='code_line'>
                <pre>            File.rename(file_path + "/temp_" + d.upload_file_name, file_path + "/" + d.upload_file_name)</pre>
              </td>
              <td class='hit_number'>0</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>174</td>
              <td class='code_line'>
                <pre>          end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>175</td>
              <td class='code_line'>
                <pre>          </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>176</td>
              <td class='code_line'>
                <pre>          zipfile.add("#{d.upload_file_name}", "#{file_path}/#{d.upload_file_name}")</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>177</td>
              <td class='code_line'>
                <pre>       end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>178</td>
              <td class='code_line'>
                <pre>     end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>179</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>180</td>
              <td class='code_line'>
                <pre>     # clean up all temp files (again, required because of the glitch in chunked file uploads)</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>181</td>
              <td class='code_line'>
                <pre>     FileUtils.rm Dir[file_path + "/temp_*"]</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>182</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>183</td>
              <td class='code_line'>
                <pre>   end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>184</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>185</td>
              <td class='code_line'>
                <pre>   # keep metadata records, but get rid of files that are no longer needed for local storate</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>186</td>
              <td class='code_line'>
                <pre>   # (storage is intended only until records are uploaded to merritt)</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>187</td>
              <td class='code_line'>
                <pre>   def purge_files(submission_log_id)</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>188</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>189</td>
              <td class='code_line'>
                <pre>    uploads = Upload.find_all_by_record_id(self.id)</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>190</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>191</td>
              <td class='code_line'>
                <pre>     # archive the file information for submission logs</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>192</td>
              <td class='code_line'>
                <pre>    uploads.each do |u|</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>193</td>
              <td class='code_line'>
                <pre>       upload_archive = UploadArchive.new</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>194</td>
              <td class='code_line'>
                <pre>       upload_archive.submission_log_id = submission_log_id</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>195</td>
              <td class='code_line'>
                <pre>       upload_archive.upload_file_name = u.upload_file_name</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>196</td>
              <td class='code_line'>
                <pre>       upload_archive.upload_file_size = u.upload_file_size</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>197</td>
              <td class='code_line'>
                <pre>       upload_archive.upload_content_type = u.upload_content_type</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>198</td>
              <td class='code_line'>
                <pre>       upload_archive.save</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>199</td>
              <td class='code_line'>
                <pre>     end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>200</td>
              <td class='code_line'>
                <pre>     </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>201</td>
              <td class='code_line'>
                <pre>     Upload.delete_all(:record_id => self.id)</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>202</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>203</td>
              <td class='code_line'>
                <pre>     file_path = "#{Rails.root}/#{DATASHARE_CONFIG['uploads_dir']}/#{self.local_id}"</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>204</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>205</td>
              <td class='code_line'>
                <pre>     # delete the files from local storage now that they have been submitted to merritt</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>206</td>
              <td class='code_line'>
                <pre>     if File.exists?("#{file_path}")</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>207</td>
              <td class='code_line'>
                <pre>       FileUtils.rm_rf Dir.glob("#{file_path}/*")</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>208</td>
              <td class='code_line'>
                <pre>     end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>209</td>
              <td class='code_line'>
                <pre>   end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>210</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>211</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>212</td>
              <td class='code_line'>
                <pre>   def send_archive_to_merritt</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>213</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>214</td>
              <td class='code_line'>
                <pre>     # tics will execute, for now, just print to screen</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>215</td>
              <td class='code_line'>
                <pre>      # note that the 2>&1 is to redirect sterr to stout</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>216</td>
              <td class='code_line'>
                <pre>    </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>217</td>
              <td class='code_line'>
                <pre>     sys_output = "curl --insecure --verbose -u #{MERRITT_CONFIG['merritt_username']}:#{MERRITT_CONFIG['merritt_password']} -F \"file=@./#{DATASHARE_CONFIG['uploads_dir']}/#{self.local_id}/#{self.local_id}.zip\" -F \"type=container\" -F \"submitter=#{self.user.external_id}\" -F \"responseForm=xml\" -F \"profile=#{MERRITT_CONFIG['merritt_profile']}\" -F \"localIdentifier=#{self.local_id}\" #{MERRITT_CONFIG['merritt_endpoint']} 2>&1"</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>218</td>
              <td class='code_line'>
                <pre>          </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>219</td>
              <td class='code_line'>
                <pre>     return sys_output  </pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>220</td>
              <td class='code_line'>
                <pre>   end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>221</td>
              <td class='code_line'>
                <pre>   </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>222</td>
              <td class='code_line'>
                <pre>   def required_fields</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>223</td>
              <td class='code_line'>
                <pre>    </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>224</td>
              <td class='code_line'>
                <pre>      required_fields = Array.new</pre>
              </td>
              <td class='hit_number'>16</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>225</td>
              <td class='code_line'>
                <pre>    </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>226</td>
              <td class='code_line'>
                <pre>      if self.creators.nil? || self.creators.empty?</pre>
              </td>
              <td class='hit_number'>16</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>227</td>
              <td class='code_line'>
                <pre>        required_fields << "Record must specify at least one creator"</pre>
              </td>
              <td class='hit_number'>10</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>228</td>
              <td class='code_line'>
                <pre>      end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>229</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>230</td>
              <td class='code_line'>
                <pre>      # should we allow multiple titles?  datacite does...</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>231</td>
              <td class='code_line'>
                <pre>      # we're only allowing one title per record</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>232</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>233</td>
              <td class='code_line'>
                <pre>      if self.title.nil? || self.title.blank?</pre>
              </td>
              <td class='hit_number'>16</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>234</td>
              <td class='code_line'>
                <pre>        required_fields << "Record must have a title"</pre>
              </td>
              <td class='hit_number'>10</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>235</td>
              <td class='code_line'>
                <pre>      end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>236</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>237</td>
              <td class='code_line'>
                <pre>      # publisher - datacite: single, mandatory</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>238</td>
              <td class='code_line'>
                <pre>      if self.publisher.nil? || self.publisher.blank?</pre>
              </td>
              <td class='hit_number'>16</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>239</td>
              <td class='code_line'>
                <pre>        required_fields << "Record must have a publisher"</pre>
              </td>
              <td class='hit_number'>10</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>240</td>
              <td class='code_line'>
                <pre>      end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>241</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>242</td>
              <td class='code_line'>
                <pre>      # publication year - datacite: single, mandatory</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>243</td>
              <td class='code_line'>
                <pre>      if self.publicationyear.nil?</pre>
              </td>
              <td class='hit_number'>16</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>244</td>
              <td class='code_line'>
                <pre>        required_fields << "Record must have a publication year"</pre>
              </td>
              <td class='hit_number'>10</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>245</td>
              <td class='code_line'>
                <pre>      end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>246</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>247</td>
              <td class='code_line'>
                <pre>      #contributors - datacite: multiple, optional, mandatory contributorType attribute</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>248</td>
              <td class='code_line'>
                <pre>      # we will require contributors for datashare</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>249</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>250</td>
              <td class='code_line'>
                <pre>      if self.contributors.nil? || self.contributors.empty?</pre>
              </td>
              <td class='hit_number'>16</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>251</td>
              <td class='code_line'>
                <pre>        required_fields << "Record must specify at least one contributor"</pre>
              </td>
              <td class='hit_number'>10</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>252</td>
              <td class='code_line'>
                <pre>      end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>253</td>
              <td class='code_line'>
                <pre>    </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>254</td>
              <td class='code_line'>
                <pre>      return required_fields</pre>
              </td>
              <td class='hit_number'>16</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>255</td>
              <td class='code_line'>
                <pre>   end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>256</td>
              <td class='code_line'>
                <pre>   </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>257</td>
              <td class='code_line'>
                <pre>   def recommended_fields</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>258</td>
              <td class='code_line'>
                <pre>   </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>259</td>
              <td class='code_line'>
                <pre>      recommended_fields = Array.new</pre>
              </td>
              <td class='hit_number'>4</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>260</td>
              <td class='code_line'>
                <pre>            </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>261</td>
              <td class='code_line'>
                <pre>      # subjects - datacite: multiple, optional</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>262</td>
              <td class='code_line'>
                <pre>      if self.subjects.nil? || self.subjects.empty?</pre>
              </td>
              <td class='hit_number'>4</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>263</td>
              <td class='code_line'>
                <pre>        recommended_fields << "Subject data is strongly recommended.  Your record may be ommitted from search and browse results withough a subject"</pre>
              </td>
              <td class='hit_number'>2</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>264</td>
              <td class='code_line'>
                <pre>      end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>265</td>
              <td class='code_line'>
                <pre>      </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>266</td>
              <td class='code_line'>
                <pre>      #descriptions</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>267</td>
              <td class='code_line'>
                <pre> </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>268</td>
              <td class='code_line'>
                <pre>      if self.abstract == "" || self.methods == ""</pre>
              </td>
              <td class='hit_number'>4</td>
            </tr>
          
            <tr class="miss" data-hits='#{cov}'"">
              <td class='line_number'>269</td>
              <td class='code_line'>
                <pre>        recommended_fields << "While not required, an abstract and technical description are strongly recommended."</pre>
              </td>
              <td class='hit_number'>0</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>270</td>
              <td class='code_line'>
                <pre>      end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>271</td>
              <td class='code_line'>
                <pre> </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>272</td>
              <td class='code_line'>
                <pre>      return recommended_fields</pre>
              </td>
              <td class='hit_number'>4</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>273</td>
              <td class='code_line'>
                <pre>   </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>274</td>
              <td class='code_line'>
                <pre>   end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>275</td>
              <td class='code_line'>
                <pre>  </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>276</td>
              <td class='code_line'>
                <pre>end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
        </table>
      </div>
      
    </div>
    
    <p>Generated on: 2014-01-27 09:46:36 -0800</p>
  </body>
</html>