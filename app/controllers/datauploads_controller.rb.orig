class DatauploadsController < ApplicationController

  before_filter :verify_ownership
  
  def destroy
     @upload = Upload.find(params[:dataupload_id])
     @record = Record.find(@upload.record_id)
     @upload.destroy

     redirect_to "/record/#{@record.id}/uploads"
   end

   def verify_ownership 
     @user = current_user
     @record = Record.find_by_id(params[:id])
     #@institution = Institution.find_by_id(session[:institution_id])
      
    @institution = current_user.institution if current_user
    
     if !current_user.nil? && !@record.nil?
       if @record.user_id != current_user.id
         redirect_to "/records"
       end
     end
  end
   
 end
